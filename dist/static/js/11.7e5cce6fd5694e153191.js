webpackJsonp([11],{DJYb:function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container _importfile"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.dialogEdittVisible,expression:"!dialogEdittVisible"}]},[a("el-form",{ref:"formSearch",staticClass:"demo-form-inline",attrs:{"label-position":"right","label-width":"68px",inline:!0,model:e.formSearch}},[a("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"文件名称"},model:{value:e.formSearch.name,callback:function(t){e.$set(e.formSearch,"name",t)},expression:"formSearch.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"文件类型"},model:{value:e.formSearch.type,callback:function(t){e.$set(e.formSearch,"type",t)},expression:"formSearch.type"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"知识库文件",value:"知识库文件"}}),e._v(" "),a("el-option",{attrs:{label:"办公软件包",value:"办公软件包"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"0"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.onReset}},[e._v("重置")])],1)],1),e._v(" "),a("el-form",[a("el-form-item",[a("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.onOpenAdd}},[e._v("导入文件")]),e._v(" "),a("el-button",{attrs:{size:"small",round:"",type:"danger"},on:{click:e.onDeleteMany}},[e._v("批量删除")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"文件名称",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{color:"#00D1B2"},attrs:{href:t.row.url,target:"_blank"},on:{click:function(a){return e.onDetail(t.$index,t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"文件类型",align:"center","min-width":"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"des",label:"文件描述",align:"center","min-width":"160"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"导入日期",align:"center",formatter:this.$common.timestampToTime,"min-width":"160"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:t.row.url,download:t.row.name}},[a("el-button",{attrs:{size:"mini"}},[e._v("下载")])],1),e._v(" "),a("el-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return e.onDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total,sizes,prev, pager, next,jumper","current-page":e.pageInfo.currentPage,"page-size":e.pageInfo.pageSize,total:e.pageInfo.pageTotal,"page-sizes":[5,10,20,50]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogEdittVisible,expression:"dialogEdittVisible"}]},[a("el-form",{ref:"formEdit",staticClass:"demo-form-inline",attrs:{"label-position":"right","label-width":"80px",rules:e.rulesEdit,disabled:e.formEditDisabled,inline:!1,model:e.formEdit}},[a("el-form-item",{attrs:{label:"上传文件"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传\n                        "),a("input",{staticStyle:{opacity:"0",width:"80px",height:"100%",position:"absolute",top:"0",left:"0",cursor:"pointer"},attrs:{type:"file"},on:{change:function(t){return e.getFile(t)}}})]),e._v(" "),a("span",{class:{"el-icon-success":this.file,"el-icon-warning":!this.file}},[e._v(e._s(this.file?"已上传":"未上传"))])],1),e._v(" "),a("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"文件名称"},model:{value:e.formEdit.name,callback:function(t){e.$set(e.formEdit,"name",t)},expression:"formEdit.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"文件类型"},model:{value:e.formEdit.type,callback:function(t){e.$set(e.formEdit,"type",t)},expression:"formEdit.type"}},[a("el-option",{attrs:{label:"知识库文件",value:"知识库文件"}}),e._v(" "),a("el-option",{attrs:{label:"办公软件包",value:"办公软件包"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文件描述",prop:"des"}},[a("el-input",{attrs:{placeholder:"文件描述"},model:{value:e.formEdit.des,callback:function(t){e.$set(e.formEdit,"des",t)},expression:"formEdit.des"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.onCancel}},[e._v("取 消")]),e._v(" "),e.formEditDisabled?e._e():a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSave(t)}}},[e._v("确 定")])],1)],1)])},staticRenderFns:[]};t.a=i},EqFp:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("nNqi"),n=a.n(i);for(var l in i)"default"!==l&&function(e){a.d(t,e,function(){return i[e]})}(l);var o=a("DJYb");var r=function(e){a("sE5j")},s=a("C7Lr")(n.a,o.a,!1,r,null,null);t.default=s.exports},nNqi:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(a("aA9S")),n=l(a("qzrg"));function l(e){return e&&e.__esModule?e:{default:e}}t.default={name:"fileimport",data:function(){return{formSearch:{name:"",type:""},formEdit:{id:"",name:"",type:"",des:"",url:""},file:null,rulesEdit:{name:[{required:!0,message:"请输入文件名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请输入文件类型",trigger:"change"}]},tableData:[{name:"个人年度报告",type:"办公类文件",des:"这是一个年度报告",url:"#",createTime:"2019-11-17 20:01:13"}],listLoading:!1,multipleSelection:[],pageInfo:{currentPage:1,pageSize:5,pageTotal:80},formEditTitle:"新增",dialogEdittVisible:!1,formEditDisabled:!1}},mounted:function(){this.onSearch()},methods:{onSearch:function(){var e=this;this.listLoading=!0;var t=(0,i.default)({},this.formSearch,this.pageInfo);n.default.fileImportApi.getList(t).then(function(t){if(e.listLoading=!1,t&&t.data){var a=t.data;"SUCCESS"==a.status?(e.pageInfo.pageTotal=a.count,e.tableData=a.data):a.message&&e.$message({message:a.message,type:"error"})}}).catch(function(t){e.listLoading=!1,e.$message({message:"查询异常，请重试",type:"error"})})},onReset:function(){this.$refs.formSearch.resetFields()},onOpenAdd:function(){this.dialogEdittVisible=!0},getFile:function(e){this.file=e.target.files[0],e.target.value="",this.file?this.formEdit.name=this.file.name:this.formEdit.name="",console.log(this.file)},onDeleteMany:function(){var e=this,t=this.multipleSelection.map(function(e){return e.id});0!=t.length?this.$confirm("此操作将批量永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.default.kbmsApi.deleteBatch({ids:t}).then(function(t){e.$common.isSuccess(t,function(){e.onSearch()})}).catch(function(t){e.$message({message:"执行失败，请重试",type:"error"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({message:"请选择要删除的项",type:"warn"})},onDetail:function(){},onDelete:function(e,t){var a=this,i=t.id;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.default.fileImportApi.delete({id:i}).then(function(e){a.$common.isSuccess(e,function(){a.onSearch()})}).catch(function(e){a.$message({message:"执行失败，请重试",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},onSave:function(e){var t=this;e.preventDefault(),this.$refs.formEdit.validate(function(e){e&&t.file&&n.default.fileImportApi.updateFile({file:t.file}).then(function(e){var a=e.data;if(a.uploaded&&"true"==a.uploaded){t.formEdit.url=a.url;var l=(0,i.default)({},t.formEdit);n.default.fileImportApi.add(l).then(function(e){if(e&&e.data){var a=e.data;if(a&&"SUCCESS"==a.status)return t.$message({message:"上传成功",type:"success"}),t.onSearch(),void t.onCancel()}t.$message({message:"执行失败，请重试",type:"error"})}).catch(function(e){t.$message({message:"执行失败，请重试",type:"error"})})}else t.$message({message:a.message,type:"error"})}).catch(function(e){t.$message({message:e.message,type:"error"})})})},onCancel:function(){this.$refs.formEdit.resetFields(),this.dialogEdittVisible=!1,this.file=null},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.onSearch()},handleCurrentChange:function(e){this.pageInfo.currentPage=e,this.onSearch()},closeDialog:function(e){this.$refs[e].resetFields()}}}},sE5j:function(e,t){}});
//# sourceMappingURL=11.7e5cce6fd5694e153191.js.map