webpackJsonp([5],{"3BQw":function(e,t,a){"use strict";var i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container _msg"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isTableShow,expression:"isTableShow"}]},[a("el-form",{ref:"formSearch",staticClass:"demo-form-inline",attrs:{"label-position":"right","label-width":"80px",inline:!0,model:e.formSearch}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"模糊匹配"},model:{value:e.formSearch.title,callback:function(t){e.$set(e.formSearch,"title",t)},expression:"formSearch.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"发布状态",prop:"publicState"}},[a("el-select",{attrs:{placeholder:"发布状态"},model:{value:e.formSearch.publicState,callback:function(t){e.$set(e.formSearch,"publicState",t)},expression:"formSearch.publicState"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"已发布",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"未发布",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"存管银行",prop:"depositoryBank"}},[a("el-select",{attrs:{placeholder:"存管银行"},model:{value:e.formSearch.depositoryBank,callback:function(t){e.$set(e.formSearch,"depositoryBank",t)},expression:"formSearch.depositoryBank"}},[a("el-option",{attrs:{label:"全部",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"百信银行",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"厦门银行",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.formSearch.createTime,callback:function(t){e.$set(e.formSearch,"createTime",t)},expression:"formSearch.createTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"更新时间",prop:"updateTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.formSearch.updateTime,callback:function(t){e.$set(e.formSearch,"updateTime",t)},expression:"formSearch.updateTime"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-left":"0px"},attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.onReset}},[e._v("重置")])],1)],1),e._v(" "),a("el-row",{staticClass:"mgb15"},[a("el-button",{attrs:{size:"small",round:"",type:"primary"},on:{click:e.handleAdd}},[e._v("新增")]),e._v(" "),a("el-button",{attrs:{size:"small",round:"",type:"danger"},on:{click:e.deleteMany}},[e._v("批量删除")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"150",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{color:"#00D1B2"},attrs:{href:"javacript:;"},on:{click:function(a){return e.handleDetail(t.$index,t.row)}}},[e._v(e._s(t.row.title))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"内容",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticClass:"line-limit-length"},[e._v(e._s(e._f("convertContent")(t.row.content)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"publicState",label:"发布状态",align:"center",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建日期",align:"center",formatter:this.$common.timestampToTime,width:"160",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"更新日期",align:"center",formatter:this.$common.timestampToTime,width:"160",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"260"},scopedSlots:e._u([{key:"default",fn:function(t){return["未发布"==t.row.publicState||""==t.row.publicState?a("span",[a("el-button",{attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(a){return e.updatePublicState(t.$index,t.row,"已发布")}}},[e._v(e._s(e._f("convertPublic")(t.row.publicState)))])],1):a("span",[a("el-button",{attrs:{size:"mini",plain:"",type:"warning"},on:{click:function(a){return e.updatePublicState(t.$index,t.row,"未发布")}}},[e._v(e._s(e._f("convertPublic")(t.row.publicState)))])],1),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",plain:"",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"total,sizes,prev, pager, next,jumper","current-page":e.pageInfo.currentPage,"page-size":e.pageInfo.pageSize,total:e.pageInfo.pageTotal,"page-sizes":[5,10,20,50]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEditShow,expression:"isEditShow"}],staticClass:"_edit"},[a("el-form",{ref:"formEdit",staticClass:"demo-form-inline",attrs:{"label-position":e.labelPosition,"label-width":e.labelWidth,rules:e.rulesEdit,disabled:e.formEditDisabled,inline:!1,model:e.formEdit}},[a("el-form-item",{attrs:{"label-width":"0",prop:"title"}},[a("el-input",{staticClass:"docTitle",attrs:{maxlength:"50",placeholder:"输入文档标题"},model:{value:e.formEdit.title,callback:function(t){e.$set(e.formEdit,"title",t)},expression:"formEdit.title"}})],1),e._v(" "),a("el-form-item",{staticClass:"_editor",attrs:{"label-width":"0"}},[a("div",{staticClass:"document-editor"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.formEditDisabled,expression:"!formEditDisabled"}],staticClass:"document-editor__toolbar"}),e._v(" "),a("div",{staticClass:"document-editor__editable-container"},[a("div",{staticClass:"document-editor__editable"},[a("p",[e._v("CSDN同款富文本编辑器，支持将截图直接粘贴进来")])])])])]),e._v(" "),a("el-form-item",{attrs:{label:"存管银行",prop:"depositoryBank"}},[a("el-select",{attrs:{placeholder:"存管银行"},model:{value:e.formEdit.depositoryBank,callback:function(t){e.$set(e.formEdit,"depositoryBank",t)},expression:"formEdit.depositoryBank"}},[a("el-option",{attrs:{label:"农业银行",value:"农业银行"}}),e._v(" "),a("el-option",{attrs:{label:"交通银行",value:"交通银行"}}),e._v(" "),a("el-option",{attrs:{label:"北京银行",value:"北京银行"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeEdit}},[e._v("取 消")]),e._v(" "),e.formEditDisabled?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v(e._s(e.editBtnText))]),e._v(" "),"add"==e.dialogType||"edit"==e.dialogType&&"未发布"==e.formEdit.publicState?a("el-button",{attrs:{type:"primary"},on:{click:e.handlePublic}},[e._v("发布")]):e._e()],1)],1)])},staticRenderFns:[]};t.a=i},BK5E:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("o7nP"),o=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,function(){return i[e]})}(n);var r=a("3BQw");var l=function(e){a("FN7u")},s=a("C7Lr")(o.a,r.a,!1,l,null,null);t.default=s.exports},FN7u:function(e,t){},o7nP:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(a("aA9S")),o=n(a("qzrg"));function n(e){return e&&e.__esModule?e:{default:e}}t.default={name:"msg",data:function(){return{listLoading:!1,pageInfo:{currentPage:1,pageSize:5,pageTotal:80},formSearch:{title:"",keyword:"",createStartDate:null,createEndDate:null,updateStartDate:null,updateEndDate:null,createTime:null,updateTime:null},formEdit:{title:"",content:"",depositoryBank:"",publicState:"未发布"},rulesEdit:{title:[{required:!0,message:"请输入文档标题",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}]},formEditTitle:"编辑",formEditDisabled:!1,dialogType:"",tableData:[{id:"1",title:"",depositoryBank:"",content:"",createTime:null,updateTime:null,publicState:""}],labelPosition:"right",labelWidth:"80px",isTableShow:!0,isEditShow:!1,editBtnText:"保存",EditorObj:null}},mounted:function(){this.onSearch(),this.initCKEditor()},methods:{onSearch:function(){var e=this;this.listLoading=!0,this.formSearch.createTime&&(this.formSearch.createStartDate=this.formSearch.createTime[0],this.formSearch.createEndDate=this.formSearch.createTime[1]);var t=(0,i.default)({},this.formSearch,this.pageInfo);o.default.msgApi.getList(t).then(function(t){if(e.listLoading=!1,t&&t.data){var a=t.data;"SUCCESS"==a.status?(e.pageInfo.pageTotal=a.count,e.tableData=a.data):a.message&&e.$message({message:a.message,type:"error"})}}).catch(function(t){e.listLoading=!1,e.$message({message:"查询异常，请重试",type:"error"})})},handleSave:function(){"add"==this.dialogType?this.save():"edit"==this.dialogType?this.update():this.$message({message:"操作异常",type:"error"})},save:function(){var e=this;this.$refs.formEdit.validate(function(t){if(t){var a=(0,i.default)({},e.formEdit);a.content=e.EditorObj.getData(),o.default.msgApi.add(a).then(function(t){if(t&&t.data){var a=t.data;if(a&&"SUCCESS"==a.status)return e.$message({message:"执行成功",type:"success"}),e.closeEdit(),void e.onSearch()}e.$message({message:"执行失败，请重试",type:"error"})}).catch(function(t){e.$message({message:"执行失败，请重试",type:"error"})})}})},update:function(){var e=this;this.$refs.formEdit.validate(function(t){if(t){var a=(0,i.default)({},e.formEdit);a.content=e.EditorObj.getData(),o.default.msgApi.update(a).then(function(t){if(t&&t.data){var a=t.data;if(a&&"SUCCESS"==a.status)return e.$message({message:"执行成功",type:"success"}),e.closeEdit(),void e.onSearch()}e.$message({message:"执行失败，请重试",type:"error"})}).catch(function(t){e.$message({message:"执行失败，请重试",type:"error"})})}})},handleDelete:function(e,t){var a=this,i=t.id;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.default.msgApi.delete({id:i}).then(function(e){a.$common.isSuccess(e,function(){a.onSearch()})}).catch(function(e){a.$message({message:"执行失败，请重试",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deleteMany:function(){var e=this,t=this.multipleSelection.map(function(e){return e.id});0!=t.length?this.$confirm("此操作将批量永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.default.msgApi.deleteBatch({ids:t}).then(function(t){e.$common.isSuccess(t,function(){e.onSearch()})}).catch(function(t){e.$message({message:"执行失败，请重试",type:"error"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({message:"请选择要删除的项",type:"warn"})},handlePublic:function(){this.formEdit.publicState="已发布","add"==this.dialogType?this.save():"edit"==this.dialogType?this.update():this.$message({message:"操作异常",type:"error"})},updatePublicState:function(e,t,a){var i=this,n=t.id,r="已发布"==a?"发布成功":"取消发布成功";o.default.msgApi.updatePublicState({id:n,publicState:a}).then(function(e){i.$common.isSuccess(e,function(){i.$message({type:"success",message:r}),i.onSearch()})}).catch(function(e){i.$message({message:"执行失败，请重试",type:"error"})})},handleAdd:function(){var e=this;this.openEdit(),this.$nextTick(function(){e.dialogType="add",e.formEditTitle="新增",e.editBtnText="保存",e.formEditDisabled=!1,e.EditorObj.isReadOnly=!1,e.EditorObj.setData("CSDN同款富文本编辑器，支持将截图直接粘贴进来")})},handleEdit:function(e,t){var a=this;this.openEdit(),this.$nextTick(function(){a.dialogType="edit",a.formEditTitle="编辑",a.editBtnText="保存修改",a.formEditDisabled=!1,a.formEdit=(0,i.default)({},t),a.EditorObj.setData(null==a.formEdit.content?"":a.formEdit.content),a.EditorObj.isReadOnly=!1})},openEdit:function(){this.isTableShow=!1,this.isEditShow=!0},initCKEditor:function(){var e=this;DecoupledEditor.create(document.querySelector(".document-editor__editable"),{ckfinder:{uploadUrl:"/api/img-api/upload"}}).then(function(t){document.querySelector(".document-editor__toolbar").appendChild(t.ui.view.toolbar.element),e.EditorObj=t,console.log("初始化富编辑器")}).catch(function(e){console.error(e),console.log("初始化富编辑器失败")})},closeEdit:function(){this.$refs.formEdit.resetFields(),this.isTableShow=!0,this.isEditShow=!1},onPublic:function(){},onReset:function(){this.$refs.formSearch.resetFields()},handleSelectionChange:function(e){this.multipleSelection=e},handleDetail:function(e,t){var a=this;this.openEdit(),this.$nextTick(function(){a.dialogType="show",a.formEditTitle="详情",a.formEditDisabled=!0,a.formEdit=(0,i.default)({},t),a.EditorObj.setData(null==a.formEdit.content?"":a.formEdit.content),a.EditorObj.isReadOnly=!0})},handleSizeChange:function(e){this.pageInfo.pageSize=e,this.onSearch()},handleCurrentChange:function(e){this.pageInfo.currentPage=e,this.onSearch()}},filters:{convertPublic:function(e){return"未发布"==e?"执行发布":"已发布"==e?"取消发布":"执行发布"},convertContent:function(e){return e?e.replace(/<[^>]*>/gi,"").replace(/\&nbsp;/g,""):""},convertKeyWords:function(e){return e&&e.length>0?e.join(","):""}}}}});
//# sourceMappingURL=5.f47cad4b90b79115b242.js.map